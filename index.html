<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>AxiosSingular examples</title>
    <link rel="stylesheet"
            href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
            integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
            crossorigin="anonymous">
    <link rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/prismjs@1.17.1/themes/prism-okaidia.css">

    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.17.1/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.17.1/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.0/axios.min.js"
            integrity="sha256-S1J4GVHHDMiirir9qsXWc8ZWw74PHHafpsHp5PXtjTs="
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@deleteagency/live-highlight@0.0.1/build/live-highlight.min.js"></script>

    <script src="build/axios-singular.min.js"></script>
</head>

<script>
    LiveHighlight.bootstrap((element, type) => {
        function getLanguage(type) {
            switch (type) {
                case LiveHighlight.TYPE_JAVASCRIPT:
                    return 'js';
                case LiveHighlight.TYPE_STYLES:
                    return 'css';
                case LiveHighlight.TYPE_HTML:
                    return 'markup';
            }
        }

        element.className = `lang-${getLanguage(type)}`;
        Prism.highlightElement(element);
    });
</script>
<body>
<div class="py-4">
    <div class="container">
        <h2>Simple example</h2>

        <div data-live-highlight-target="simple"></div>

        <div class="mb-5">
            <div data-live-highlight="simple">
                <button class="btn btn-primary" id="load">Send a request</button>
                <button class="btn btn-primary" id="cancel">Cancel</button>
                <div class="mt-3 alert alert-info" role="alert" id="content">
                </div>
            </div>
            <p>
                Open Chrome Dev Tools Network Tab and enable network throttling to achieve sending parallel requests.
                Hit Send a request button a few times and you will see that once another request is sent while previous is still in progress
                the previous is canceled so just one request at the time is active
            </p>
            <p>
                Note: if you testing it locally within the cloned repo - make sure you are opening this file via web server. file:/// doesn't work with CORS
                so you won't be able to send request with axios, so it has to be something like http://localhost:3000/index.html
            </p>
        </div>

        <script data-live-highlight="simple">
            const loadButton = document.getElementById('load');
            const cancelButton = document.getElementById('cancel');
            const axiosSingular = new AxiosSingular(axios);

            loadButton.addEventListener('click', () => {
                axiosSingular.get('examples/test.json').then(response => {
                    console.log('Request was successful ')
                }, (error) => {
                    if (axios.isCancel(error)) {
                        console.log('Request was canceled');
                    }
                })
            });

            cancelButton.addEventListener('click', () => {
                axiosSingular.cancel('Canceled by user');
            })
        </script>
    </div>
</div>
</body>
</html>